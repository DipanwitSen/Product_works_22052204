{% extends "base.html" %} {% block title %}{{ product.name }}{% endblock %} {%
block content %}
<div class="card" style="max-width: 800px; margin: 0 auto; padding: 30px">
  <div style="display: flex; gap: 30px; align-items: flex-start">
    <img
      src="{{ product.image_url or 'https://via.placeholder.com/300' }}"
      alt="{{ product.name }}"
      style="
        width: 300px;
        height: 300px;
        border-radius: 12px;
        object-fit: cover;
      "
    />
    <div style="flex: 1">
      <h2>{{ product.name }}</h2>
      <p style="font-weight: 700; font-size: 24px; color: var(--primary-color)">
        â‚¹{{ "{:,.2f}".format(product.price) }}
      </p>

      <p style="color: #555">
        <strong style="color: #333">In Stock:</strong> {{ product.stock }}
      </p>

      <div style="margin-top: 15px">
        <h4 style="margin-bottom: 5px">Specifications</h4>
        <p style="color: var(--muted-text); font-size: 14px">
          {{ product.specifications or 'No detailed specifications provided.' }}
        </p>
        <p style="font-size: 12px; color: var(--muted-text)">
          Manufactured in: {{ product.manufacturing_area or 'Unknown' }}
        </p>
      </div>

      {% if session.get('role') == 'seller' and session.get('user_id') ==
      product.seller_id %}
      <div
        style="
          display: flex;
          gap: 10px;
          margin-top: 20px;
          border-top: 1px solid #eee;
          padding-top: 15px;
        "
      >
        <a
          href="{{ url_for('edit_product', product_id=product.id) }}"
          class="btn btn-ghost"
          style="flex: 1; border: 1px solid var(--primary-color)"
        >
          Edit Product
        </a>

        <form
          method="POST"
          action="{{ url_for('delete_product', product_id=product.id) }}"
          onsubmit="return confirm('Are you sure you want to delete this product? This action cannot be undone.');"
          style="flex: 1"
        >
          <button
            type="submit"
            class="btn btn-primary"
            style="
              width: 100%;
              background-color: #dc3545;
              border-color: #dc3545;
            "
          >
            Delete Product
          </button>
        </form>
      </div>

      {% elif session.get('role') == 'user' %}
      <form
        action="{{ url_for('add_to_cart', product_id=product.id) }}"
        method="POST"
        style="margin-top: 25px"
      >
        {% if product.variant %}
        <div class="form-group">
          <label for="variant" style="font-size: 14px">Select Variant:</label>
          <select
            id="variant"
            name="variant"
            style="
              padding: 8px;
              border-radius: 6px;
              border: 1px solid #ddd;
              width: 100%;
            "
          >
            {% for v in product.variant.split(', ') %}
            <option value="{{ v }}">{{ v }}</option>
            {% endfor %}
          </select>
        </div>
        {% else %}
        <input type="hidden" name="variant" value="" />
        {% endif %}

        <div
          style="
            display: flex;
            gap: 10px;
            align-items: center;
            margin-bottom: 20px;
          "
        >
          <label for="quantity" style="margin-bottom: 0">Quantity:</label>
          <input
            type="number"
            id="quantity"
            name="quantity"
            min="1"
            max="{{ product.stock }}"
            value="1"
            style="width: 80px; text-align: center; margin-bottom: 0"
          />
        </div>

        <div style="display: flex; gap: 10px">
          <button type="submit" class="btn btn-primary" style="flex: 1">
            Add to Cart
          </button>
          <a
            href="{{ url_for('add_to_wishlist', product_id=product.id) }}"
            class="btn btn-ghost"
            style="padding: 10px 15px; display: flex; align-items: center"
            >&#9825; Wishlist</a
          >
        </div>
      </form>

      {% else %}
      <p style="margin-top: 20px; color: var(--muted-text)">
        Log in as a **User** to buy this product.
      </p>
      {% endif %}
    </div>
  </div>
</div>
{% endblock %}
